<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.x8.mt.dao.PermissionInfoDao">
	
	<!-- 根据用户id查询权限菜单列表 -->
	<select id="findMenuListByUserid" parameterType="int" resultType="com.x8.mt.entity.PermissionInfo">
		select * from permission_info 
			where resType = 'menu'
			And id in 
				(select permissionId  from role_permission 
					where roleId in 
						(select roleId from user_role 
							where userId = #{id}))
	</select>
	
	<!-- 根据用户id查询权限信息 -->
	<select id="findPermissionByUserId" parameterType="String" resultType="com.x8.mt.entity.PermissionInfo">
		select * from permission_info
			where resType = 'permission'
				And id in 
					(select permissionId from role_permission
						where roleId in
							(select roleId from user_role
								where userId = #{userid}))
	</select>
	
	
	<!-- 查询权限列表 -->
	<select id="findPermissionList" resultType="com.x8.mt.entity.PermissionInfo">
		select * from permission_info
	</select>
	
	<!-- 根据权限名称模糊查询权限 -->
	<select id="findPermissionByPname" parameterType="String" resultType="com.x8.mt.entity.PermissionInfo">
		select * from permission_info where permissionName like '%${permissionName}%'
	</select>
	
	<!-- 根据角色名称查询给角色具有的权限 -->
	<select id="findPermissionByRoleName" parameterType="String" resultType="com.x8.mt.entity.PermissionInfo">
		select * from permission_info where id in 
			(select permissionId from role_permission where roleId in
				(select id from systemrole where rolename = #{roleName}))
	</select>
</mapper>